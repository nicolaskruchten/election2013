<html>
<head>
	<title>Ã‰lection 2013</title>
	<meta charset="utf-8"> 
    <script type="text/javascript" src="jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="coffee-script.js"></script>
    <script type="text/javascript" src="protovis.min.js"></script>
    <script type="text/coffeescript" src="helpers.coffee"></script>
	<script type="text/coffeescript" src="mayors.coffee"> </script>
	<script type="text/coffeescript" src="council.coffee"> </script>
	<script type="text/coffeescript" src="singleRace.coffee"> </script>
	<script type="text/coffeescript" src="multiRace.coffee"> </script>
</head>
<style>
.container {
	position: absolute; 
	top:0px; 
	left: 0px; 
	width: 100%; 
	height: 100%; 
	border: 1px solid white;
}
</style>
<body>

<table> 
	<tr><td>

<div id="tl" style="position: relative; width: 500px; height: 300px;">
	<div id="mayors" class="container"></div>
	<div id="mc" class="container"></div>
	<div id="cv" class="container"></div>
	<div id="ca" class="container"></div>
	<div id="all" class="container"></div>
</div>
</td><td>
<div id="tr" style="position: relative; width: 500px; height: 300px;">
	<div id="multiRaceWithin" class="container"></div>
	<div id="multiRaceAbove" class="container"></div>
</div>
</td></tr>

<tr><td>

<div id="bl" style="position: relative; width: 500px; height: 300px;">
	<div id="singleRaceA" class="container"></div>
	<div id="singleRaceB" class="container"></div>
</div>
</td><td>

</td></tr>
</table>



<script type="text/coffeescript">


fadeLength = 2*1000
stayLength = 9*1000

swapper = ->
	cycleIn = ["mayors", "mc", "cv", "ca", "all"]
	loopPosIn = 0
	it = ->
		$("#"+cycleIn[loopPosIn]).fadeOut fadeLength
		loopPosIn = (loopPosIn+1)%cycleIn.length
		$("#"+cycleIn[loopPosIn]).fadeIn fadeLength, -> setTimeout it, stayLength
	return it

raceSwapper = ->
	cycleIn = ["singleRaceA", "singleRaceB"]
	loopPosIn = 0
	it = ->
		old = cycleIn[loopPosIn]
		$("#"+cycleIn[loopPosIn]).fadeOut fadeLength, -> 
			window.updateRandomRace(old)
			$("#"+old).hide()
		loopPosIn = (loopPosIn+1)%cycleIn.length
		$("#"+cycleIn[loopPosIn]).fadeIn fadeLength, -> setTimeout it, stayLength
	return it

multiRaceSwapper = ->
	cycleIn = ["multiRaceAbove", "multiRaceWithin"]
	loopPosIn = 0
	it = ->
		$("#"+cycleIn[loopPosIn]).fadeOut fadeLength
		loopPosIn = (loopPosIn+1)%cycleIn.length
		$("#"+cycleIn[loopPosIn]).fadeIn fadeLength, -> setTimeout it, stayLength
	return it

window.refreshData ->
	window.updateMultiRace("multiRaceAbove", "above", 0.1)
	window.updateMultiRace("multiRaceWithin", "within", 0.1)
	window.updateRandomRace("singleRaceA")
	window.updateRandomRace("singleRaceB")
	window.updateMayors("mayors")
	window.updateCouncil("mc", "MC")
	window.updateCouncil("cv", "CV")
	window.updateCouncil("ca", "CA")
	window.updateCouncil("all")
	$(".container").hide()
	$("#multiRaceAbove").show()
	$("#singleRaceA").show()
	$("#mayors").show()
	swapper()()
	setTimeout multiRaceSwapper(), 3000
	setTimeout raceSwapper(), 6000



</script>

</body>
</html>